'use client';

import { useSession } from '@/hooks/useSession';
import { ScenarioSelector } from '@/components/ScenarioSelector';
import { ChatInterface } from '@/components/ChatInterface';
import { EvaluationResult } from '@/components/EvaluationResult';

export default function Home() {
  const {
    session,
    loading,
    error,
    evaluation,
    startSession,
    sendMessage,
    evaluateCurrentSession,
    resetSession,
  } = useSession();

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
      {/* Header */}
      <header className="bg-white shadow-sm">
        <div className="max-w-7xl mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <span className="text-3xl">ğŸ’¬</span>
              <div>
                <h1 className="text-xl font-bold text-gray-800">
                  ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³SST
                </h1>
                <p className="text-xs text-gray-500">
                  Webå—è¨—é–‹ç™ºã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
                </p>
              </div>
            </div>
            {session && !evaluation && (
              <button
                onClick={resetSession}
                className="text-sm text-gray-500 hover:text-gray-700 transition-colors"
              >
                ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ä¸­æ–­
              </button>
            )}
          </div>
        </div>
      </header>

      {/* Main Content */}
      <main className="max-w-7xl mx-auto px-4 py-8">
        {error && (
          <div className="mb-4 p-4 bg-red-100 border border-red-300 rounded-lg text-red-700">
            {error}
          </div>
        )}

        {!session && !evaluation && (
          <div className="space-y-8">
            {/* Welcome Section */}
            <div className="text-center">
              <h2 className="text-3xl font-bold text-gray-800 mb-4">
                Webå—è¨—é–‹ç™ºã®
                <br />
                <span className="text-blue-600">ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŠ›</span>ã‚’
                é›ãˆã‚ˆã†
              </h2>
              <p className="text-gray-600 max-w-2xl mx-auto">
                ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€AIãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå½¹ã¨ãªã‚Šã€å—è¨—é–‹ç™ºã§ã‚ˆãã‚ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å ´é¢ã‚’
                ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã¾ã™ã€‚è¦ä»¶å®šç¾©ã€æŠ€è¡“èª¬æ˜ã€åˆæ„å½¢æˆãªã©ã€
                å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã—ã‚‡ã†ã€‚
              </p>
            </div>

            {/* Key Skills */}
            <div className="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
              {[
                { icon: 'ğŸ“‹', title: 'è¦ä»¶ç¢ºèª', desc: 'è¦æœ›ã‚’å…·ä½“åŒ–ã™ã‚‹' },
                { icon: 'ğŸ”„', title: 'æŠ€è¡“ç¿»è¨³', desc: 'éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«èª¬æ˜' },
                { icon: 'ğŸ§©', title: 'æ›–æ˜§ã•ã®æ§‹é€ åŒ–', desc: 'æŠ½è±¡ã‚’å…·ä½“ã«' },
                { icon: 'ğŸ“', title: 'è²¬ä»»ç¯„å›²', desc: 'å½¹å‰²ã‚’æ˜ç¢ºã«' },
                { icon: 'ğŸ¤', title: 'åˆæ„å½¢æˆ', desc: 'èªè­˜ã‚’åˆã‚ã›ã‚‹' },
              ].map((skill) => (
                <div
                  key={skill.title}
                  className="bg-white rounded-lg p-4 text-center shadow-sm"
                >
                  <span className="text-2xl">{skill.icon}</span>
                  <h3 className="font-medium text-green-800 mt-2">{skill.title}</h3>
                  <p className="text-xs text-gray-500 mt-1">{skill.desc}</p>
                </div>
              ))}
            </div>

            {/* Scenario Selector */}
            <ScenarioSelector onStart={startSession} loading={loading} />
          </div>
        )}

        {session && !evaluation && (
          <div className="h-[calc(100vh-200px)]">
            <ChatInterface
              scenario={session.scenario}
              messages={session.messages}
              onSendMessage={sendMessage}
              onFinish={evaluateCurrentSession}
              loading={loading}
            />
          </div>
        )}

        {evaluation && (
          <EvaluationResult
            evaluation={evaluation}
            onNewSession={resetSession}
          />
        )}
      </main>

      {/* Footer */}
      <footer className="bg-white border-t mt-auto">
        <div className="max-w-7xl mx-auto px-4 py-4">
          <p className="text-center text-sm text-gray-500">
            æ¥­å‹™ç‰¹åŒ–å‹SSTã‚¢ãƒ—ãƒª - æœªçµŒé¨“ã‹ã‚‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
          </p>
        </div>
      </footer>
    </div>
  );
}
